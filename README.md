# PODAcc

Package contains a method to calculate a gene-level Point of Departure (POD) based on the curvature of the BMD (or BMDL) accumulation plot. The method looks for the first point of inflection (or maximum curvature) in the accumulation plot. 

The following command can be used to install the package from whithin an R environment
devtools::install_git("https://github.com/edpaulacosta/podacc.git")
 
You might need to install the package devtools if that is not installed yet.
 
The following commands are an example of how to run the method, using a dataset loaded into the package.
 
# Code lines to run the method and visualize results 
library("podacc")
data = amiodarone_tggates_29day_BMD
head(data)
list_bmd_values = data[,"BMD"]
results = runPODAccMethod(list_bmd_values)
plotPODAccResults(list_bmd_values,results)
 
The output data structure “results” will have 4 fields: 
	· podacc (which is the POD call made by our method) – corresponds to green solid line in the plot generated by plotPODAccResults()
	· candidates_podacc (which are the candidate PODs output by our method. Our method might identify different inflection/curvature points. They are all candidates. Right now our call is always the candidate that is the closest to the first mode of the datapoints) – unchosen candidates are green dashed lines
	· first_mode
	· first_anti_mode 
 
To run your datasets, you just need to feed the function runPODAccMethod()  with a list of values (in our case, a list of BMD values), and it will store the results in the data structure “results”, as I explained above. 
 
I would suggest that you try to install the package and run the function for your data and let me know if you have questions. 
I would be interested in having a look at how the method works for your data. Feel free to schedule a meeting with me for us to review the results (also to solve potential technical problems),
 
Please only run the method if you have at least 5 data points, otherwise the function will return NA.
The method has also some assumptions about the expected shape of the curve (namely, concave up, using log10 scale in the x axis). You might have some problems if that does not hold.
 
